---
title: "Week 05 Homework"
author: "Brian Ritz"
date: "Monday, May 18, 2015"
output: html_document
---


Load data from TSA package (the package is written by textbook authors Jonathan Cryer and Kung-Sik Chan).

>library("TSA")

>data(beersales)

The data is the monthly beer sales in millions of barrels, 01/1975 - 12/1990.

Part 1 - use ARIMA(p,d,q) model to forecast beer sales for all months of 1990.

1A - Use the h-period in forecast() to forecast each month of 1990.

1B - Use the monthly data as a continuous time series. Forecast for 1990 Jan, Plug forecast into the time series to forecast for 1990 Feb. And so on and so forth.

1C - which of the two above approaches yield the better results in terms of Mean Squared Error 1990?

Part 2 - use month of the year seasonal ARIMA(p,d,q)(P,Q,D)s model to forecast beer sales for all the months of 1990.

Part 3 - Which model (Part 1 or Part 2) is better to forecast beer sales for each month of 1990 (Jan, Feb, ..., Dec) ? 

Due date: 2015 Feb 19th 11:59pm

```{r}
# load the dataset
library(forecast)
library("TSA")
data(beersales)
```

Create an ARIMA Model

```{r}
train <- window(beersales, start=c(1975,1), end=c(1989,12))
```

adf test checks for stationarity

```{r}
print(adf.test(train))
```

We see that it is stationary because the p-value on the adf test is 0.01. Therefore, we can restrict our model to a stationary model.
```{r}
fit <- auto.arima(train, max.P=0, max.D=0, max.Q=0, stationary = T, seasonal = F)
```


**1A - Use the h-period in forecast() to forecast each month of 1990.**

```{r}
# the h parameter gives the number of periods forward to forecast
(forecast.1990.arima <- forecast(fit, h = 12))
```

**1B - Use the monthly data as a continuous time series. Forecast for 1990 Jan, Plug forecast into the time series to forecast for 1990 Feb. And so on and so forth.**

```{r}
train.loop <- train
forecasts.loop <- c()
h<-0
while(h < 12){
  fit.loop <- auto.arima(train.loop, max.P=0, max.D=0, max.Q=0, stationary = T, seasonal = F)
  one.mo.forecast <- forecast(fit.loop, h = 1)
  
  # log the forecast we just made
  forecasts.loop <- c(forecasts.loop, one.mo.forecast$mean)
  
  # add the forecast to the training dataset
  train.loop <- ts(c(train.loop, one.mo.forecast$mean), start=start(train.loop), frequency=frequency(train.loop))
  
  # use the length of the forecasts to exit the loop if its time
  h = length(forecasts.loop)
}

(forecasts.loop <- ts(forecasts.loop, start=c(1990, 1), frequency=12))

```

